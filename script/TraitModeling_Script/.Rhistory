gall_sizeasr
gall_size <- setNames(data$gall_size, rownames(data))
levels(gall_size) <- unique(data$gall_size)
gall_size.ER <- fitpolyMk(S, gall_size, model = "ER")
gall_sizexx <- apply(gall_size.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(gall_size.ER$data))
gall_sizexx <- gsub("+","/", gall_sizexx, fixed=TRUE)
gall_size.data <- data.frame(Genus_sp = names(gall_sizexx), gall_size = gall_sizexx)
gall_size_rate.mat <- gall_size.ER$index.matrix
gall_size_rate.mat[gall_size_rate.mat==0] <- NA
colnames(gall_size_rate.mat) <- rownames(gall_size_rate.mat) <- gsub("+","/", colnames(gall_size_rate.mat), fixed=TRUE)
gall_sizeind <- order(colnames(gall_size_rate.mat))
gall_size_rate.mat <- gall_size_rate.mat[gall_sizeind, gall_sizeind]
gall_size_fit.marginal <- corHMM(S, gall_size.data,
rate.mat = gall_size_rate.mat,
node.states = "marginal",
rate.cat = 1, p = gall_size.ER$rates,
root.p = gall_size.ER$pi)
gall_sizeasr <- gall_size_fit.marginal$states
colnames(gall_sizeasr) <- colnames(gall_size_rate.mat)
colnames(gall_sizeasr) <- gsub("/","+", colnames(gall_sizeasr))
svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_gall_size_guerbrown.svg", width = 20, height = 10)
gall_sizepp <- matrix(0, length(gall_size), 5, dimnames = list(names(gall_size), c("1", "2", "3", "1+2", "2+3")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
gall_sizeX <- strsplit(setNames(as.character(gall_size_rate.mat), names(gall_size_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),5,
dimnames=list(S$tip.label,
c("1", "2", "3", "1+2", "2+3")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
gall_sizeX[[S$tip.label[i]]]]<-
rep(1/length(gall_sizeX[[S$tip.label[i]]]),
length(gall_sizeX[[S$tip.label[i]]]))
gall_sizecols <- setNames(c("firebrick1", "dodgerblue1", "grey15", "orange", "grey45"),
c("1", "2", "3"))
par(fg="white")
gall_size <- setNames(data$gall_size, data$Synergus)
gall_sizexx <- strsplit(as.character(gall_size), split = "+", fixed = T)
gall_sizepp <- matrix(0, length(gall_size), 5, dimnames = list(names(gall_size), c("1", "2", "3", "1+2", "2+3")))
for (i in 1:nrow(gall_sizepp)) gall_sizepp[i,gall_sizexx[[i]]]<-1/length(gall_sizexx[[i]])
tiplabels(pie = gall_sizepp, piecol = gall_sizecols, cex=0.3)
par(fg="white")
piecol <- gall_sizecols
for(i in 1:ncol(gall_sizeasr)){
gall_sizenn <- strsplit(colnames(gall_sizeasr)[i],"+", fixed=TRUE)[[1]]
if(length(gall_sizenn)==1) piecol[i] <- gall_sizecols[gall_sizenn]
else if(length(gall_sizenn)==2) piecol[i] <- colorRampPalette(gall_sizecols[gall_sizenn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(gall_sizeasr)
par(fg="white")
nodelabels(pie = gall_sizeasr, piecol = gall_sizecols,cex=0.40)
par(fg="black")
legend("bottom", c("1", "2", "3", "1+2", "2+3"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15", "orange", "grey45"), pt.cex = 2, title = "Gall Size", cex = 1)
dev.off()
detachable <- setNames(data$detachable, rownames(data))
levels(detachable) <- unique(data$detachable)
detachable.ER <- fitpolyMk(S, detachable, model = "ER")
detachablexx <- apply(detachable.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(detachable.ER$data))
detachablexx <- gsub("+","/", detachablexx, fixed=TRUE)
detachable.data <- data.frame(Genus_sp = names(detachablexx), detachable = detachablexx)
detachable_rate.mat <- detachable.ER$index.matrix
detachable_rate.mat[detachable_rate.mat==0] <- NA
colnames(detachable_rate.mat) <- rownames(detachable_rate.mat) <- gsub("+","/", colnames(detachable_rate.mat), fixed=TRUE)
detachableind <- order(colnames(detachable_rate.mat))
detachable_rate.mat <- detachable_rate.mat[detachableind, detachableind]
detachable_fit.marginal <- corHMM(S, detachable.data,
rate.mat = detachable_rate.mat,
node.states = "marginal",
rate.cat = 1, p = detachable.ER$rates,
root.p = detachable.ER$pi)
detachableasr <- detachable_fit.marginal$states
colnames(detachableasr) <- colnames(detachable_rate.mat)
colnames(detachableasr) <- gsub("/","+", colnames(detachableasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_detachable_guerbrown.svg", width = 20, height = 10)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
detachableX <- strsplit(setNames(as.character(detachable_rate.mat), names(detachable_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),2,
dimnames=list(S$tip.label,
c("1", "0")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
detachableX[[S$tip.label[i]]]]<-
rep(1/length(detachableX[[S$tip.label[i]]]),
length(detachableX[[S$tip.label[i]]]))
detachablecols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1"))
par(fg="white")
detachable <- setNames(data$detachable, data$Synergus)
detachablexx <- strsplit(as.character(detachable), split = "+", fixed = T)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
for (i in 1:nrow(detachablepp)) detachablepp[i,detachablexx[[i]]]<-1/length(detachablexx[[i]])
tiplabels(pie = detachablepp, piecol = detachablecols, cex=0.3)
par(fg="white")
piecol <- detachablecols
for(i in 1:ncol(detachableasr)){
detachablenn <- strsplit(colnames(detachableasr)[i],"+", fixed=TRUE)[[1]]
if(length(detachablenn)==1) piecol[i] <- detachablecols[detachablenn]
else if(length(detachablenn)==2) piecol[i] <- colorRampPalette(detachablecols[detachablenn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(detachableasr)
par(fg="white")
nodelabels(pie = detachableasr, piecol = detachablecols,cex=0.40)
par(fg="black")
legend("bottom", c("Detachable", "Integrated"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15"), pt.cex = 2, title = "Detachable", cex = 1)
#dev.off()
detachable <- setNames(data$detachable, rownames(data))
levels(detachable) <- unique(data$detachable)
detachable.ER <- fitpolyMk(S, detachable, model = "ER")
detachablexx <- apply(detachable.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(detachable.ER$data))
detachablexx <- gsub("+","/", detachablexx, fixed=TRUE)
detachable.data <- data.frame(Genus_sp = names(detachablexx), detachable = detachablexx)
detachable_rate.mat <- detachable.ER$index.matrix
detachable_rate.mat[detachable_rate.mat==0] <- NA
colnames(detachable_rate.mat) <- rownames(detachable_rate.mat) <- gsub("+","/", colnames(detachable_rate.mat), fixed=TRUE)
detachableind <- order(colnames(detachable_rate.mat))
detachable_rate.mat <- detachable_rate.mat[detachableind, detachableind]
detachable_fit.marginal <- corHMM(S, detachable.data,
rate.mat = detachable_rate.mat,
node.states = "marginal",
rate.cat = 1, p = detachable.ER$rates,
root.p = detachable.ER$pi)
detachableasr <- detachable_fit.marginal$states
colnames(detachableasr) <- colnames(detachable_rate.mat)
colnames(detachableasr) <- gsub("/","+", colnames(detachableasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_detachable_guerbrown.svg", width = 20, height = 10)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
detachableX <- strsplit(setNames(as.character(detachable_rate.mat), names(detachable_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),2,
dimnames=list(S$tip.label,
c("1", "0")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
detachableX[[S$tip.label[i]]]]<-
rep(1/length(detachableX[[S$tip.label[i]]]),
length(detachableX[[S$tip.label[i]]]))
detachablecols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1"))
par(fg="white")
detachable <- setNames(data$detachable, data$Synergus)
detachablexx <- strsplit(as.character(detachable), split = "+", fixed = T)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
for (i in 1:nrow(detachablepp)) detachablepp[i,detachablexx[[i]]]<-1/length(detachablexx[[i]])
tiplabels(pie = detachablepp, piecol = detachablecols, cex=0.3)
par(fg="white")
piecol <- detachablecols
for(i in 1:ncol(detachableasr)){
detachablenn <- strsplit(colnames(detachableasr)[i],"+", fixed=TRUE)[[1]]
if(length(detachablenn)==1) piecol[i] <- detachablecols[detachablenn]
else if(length(detachablenn)==2) piecol[i] <- colorRampPalette(detachablecols[detachablenn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(detachableasr)
par(fg="white")
nodelabels(pie = detachableasr, piecol = detachablecols,cex=0.40)
par(fg="black")
legend("bottom", c("Detachable", "Integrated", "No Preference"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15"), pt.cex = 2, title = "Detachable", cex = 1)
#dev.off()
detachable <- setNames(data$detachable, rownames(data))
levels(detachable) <- unique(data$detachable)
detachable.ER <- fitpolyMk(S, detachable, model = "ER")
detachablexx <- apply(detachable.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(detachable.ER$data))
detachablexx <- gsub("+","/", detachablexx, fixed=TRUE)
detachable.data <- data.frame(Genus_sp = names(detachablexx), detachable = detachablexx)
detachable_rate.mat <- detachable.ER$index.matrix
detachable_rate.mat[detachable_rate.mat==0] <- NA
colnames(detachable_rate.mat) <- rownames(detachable_rate.mat) <- gsub("+","/", colnames(detachable_rate.mat), fixed=TRUE)
detachableind <- order(colnames(detachable_rate.mat))
detachable_rate.mat <- detachable_rate.mat[detachableind, detachableind]
detachable_fit.marginal <- corHMM(S, detachable.data,
rate.mat = detachable_rate.mat,
node.states = "marginal",
rate.cat = 1, p = detachable.ER$rates,
root.p = detachable.ER$pi)
detachableasr <- detachable_fit.marginal$states
colnames(detachableasr) <- colnames(detachable_rate.mat)
colnames(detachableasr) <- gsub("/","+", colnames(detachableasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_detachable_guerbrown.svg", width = 20, height = 10)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
detachableX <- strsplit(setNames(as.character(detachable_rate.mat), names(detachable_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),3,
dimnames=list(S$tip.label,
c("1", "0", "1+0")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
detachableX[[S$tip.label[i]]]]<-
rep(1/length(detachableX[[S$tip.label[i]]]),
length(detachableX[[S$tip.label[i]]]))
detachablecols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1", "1+0"))
par(fg="white")
detachable <- setNames(data$detachable, data$Synergus)
detachablexx <- strsplit(as.character(detachable), split = "+", fixed = T)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
for (i in 1:nrow(detachablepp)) detachablepp[i,detachablexx[[i]]]<-1/length(detachablexx[[i]])
tiplabels(pie = detachablepp, piecol = detachablecols, cex=0.3)
par(fg="white")
piecol <- detachablecols
for(i in 1:ncol(detachableasr)){
detachablenn <- strsplit(colnames(detachableasr)[i],"+", fixed=TRUE)[[1]]
if(length(detachablenn)==1) piecol[i] <- detachablecols[detachablenn]
else if(length(detachablenn)==2) piecol[i] <- colorRampPalette(detachablecols[detachablenn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(detachableasr)
par(fg="white")
nodelabels(pie = detachableasr, piecol = detachablecols,cex=0.40)
par(fg="black")
legend("bottom", c("Detachable", "Integrated", "No Preference"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15"), pt.cex = 2, title = "Detachable", cex = 1)
#dev.off()
detachable <- setNames(data$detachable, rownames(data))
levels(detachable) <- unique(data$detachable)
detachable.ER <- fitpolyMk(S, detachable, model = "ER")
detachablexx <- apply(detachable.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(detachable.ER$data))
detachablexx <- gsub("+","/", detachablexx, fixed=TRUE)
detachable.data <- data.frame(Genus_sp = names(detachablexx), detachable = detachablexx)
detachable_rate.mat <- detachable.ER$index.matrix
detachable_rate.mat[detachable_rate.mat==0] <- NA
colnames(detachable_rate.mat) <- rownames(detachable_rate.mat) <- gsub("+","/", colnames(detachable_rate.mat), fixed=TRUE)
detachableind <- order(colnames(detachable_rate.mat))
detachable_rate.mat <- detachable_rate.mat[detachableind, detachableind]
detachable_fit.marginal <- corHMM(S, detachable.data,
rate.mat = detachable_rate.mat,
node.states = "marginal",
rate.cat = 1, p = detachable.ER$rates,
root.p = detachable.ER$pi)
detachableasr <- detachable_fit.marginal$states
colnames(detachableasr) <- colnames(detachable_rate.mat)
colnames(detachableasr) <- gsub("/","+", colnames(detachableasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_detachable_guerbrown.svg", width = 20, height = 10)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
detachableX <- strsplit(setNames(as.character(detachable_rate.mat), names(detachable_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),3,
dimnames=list(S$tip.label,
c("1", "0", "1+0")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
detachableX[[S$tip.label[i]]]]<-
rep(1/length(detachableX[[S$tip.label[i]]]),
length(detachableX[[S$tip.label[i]]]))
detachablecols <- setNames(c("firebrick1", "dodgerblue1"),
c("0", "1", "1+0"))
detachable <- setNames(data$detachable, rownames(data))
levels(detachable) <- unique(data$detachable)
detachable.ER <- fitpolyMk(S, detachable, model = "ER")
detachablexx <- apply(detachable.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(detachable.ER$data))
detachablexx <- gsub("+","/", detachablexx, fixed=TRUE)
detachable.data <- data.frame(Genus_sp = names(detachablexx), detachable = detachablexx)
detachable_rate.mat <- detachable.ER$index.matrix
detachable_rate.mat[detachable_rate.mat==0] <- NA
colnames(detachable_rate.mat) <- rownames(detachable_rate.mat) <- gsub("+","/", colnames(detachable_rate.mat), fixed=TRUE)
detachableind <- order(colnames(detachable_rate.mat))
detachable_rate.mat <- detachable_rate.mat[detachableind, detachableind]
detachable_fit.marginal <- corHMM(S, detachable.data,
rate.mat = detachable_rate.mat,
node.states = "marginal",
rate.cat = 1, p = detachable.ER$rates,
root.p = detachable.ER$pi)
detachableasr <- detachable_fit.marginal$states
colnames(detachableasr) <- colnames(detachable_rate.mat)
colnames(detachableasr) <- gsub("/","+", colnames(detachableasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_detachable_guerbrown.svg", width = 20, height = 10)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
detachableX <- strsplit(setNames(as.character(detachable_rate.mat), names(detachable_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),3,
dimnames=list(S$tip.label,
c("1", "0", "1+0")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
detachableX[[S$tip.label[i]]]]<-
rep(1/length(detachableX[[S$tip.label[i]]]),
length(detachableX[[S$tip.label[i]]]))
detachablecols <- setNames(c("firebrick1", "dodgerblue1"),
c("0", "1"))
par(fg="white")
detachable <- setNames(data$detachable, data$Synergus)
detachablexx <- strsplit(as.character(detachable), split = "+", fixed = T)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
for (i in 1:nrow(detachablepp)) detachablepp[i,detachablexx[[i]]]<-1/length(detachablexx[[i]])
tiplabels(pie = detachablepp, piecol = detachablecols, cex=0.3)
par(fg="white")
piecol <- detachablecols
for(i in 1:ncol(detachableasr)){
detachablenn <- strsplit(colnames(detachableasr)[i],"+", fixed=TRUE)[[1]]
if(length(detachablenn)==1) piecol[i] <- detachablecols[detachablenn]
else if(length(detachablenn)==2) piecol[i] <- colorRampPalette(detachablecols[detachablenn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(detachableasr)
par(fg="white")
nodelabels(pie = detachableasr, piecol = detachablecols,cex=0.40)
par(fg="black")
legend("bottom", c("Detachable", "Integrated", "No Preference"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1"), pt.cex = 2, title = "Detachable", cex = 1)
#dev.off()
detachableasr
clusterasr
cluster <- setNames(data$cluster, rownames(data))
levels(cluster) <- unique(data$cluster)
cluster.ER <- fitpolyMk(S, cluster, model = "ER")
clusterxx <- apply(cluster.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(cluster.ER$data))
clusterxx <- gsub("+","/", clusterxx, fixed=TRUE)
cluster.data <- data.frame(Genus_sp = names(clusterxx), cluster = clusterxx)
cluster_rate.mat <- cluster.ER$index.matrix
cluster_rate.mat[cluster_rate.mat==0] <- NA
colnames(cluster_rate.mat) <- rownames(cluster_rate.mat) <- gsub("+","/", colnames(cluster_rate.mat), fixed=TRUE)
clusterind <- order(colnames(cluster_rate.mat))
cluster_rate.mat <- cluster_rate.mat[clusterind, clusterind]
cluster_fit.marginal <- corHMM(S, cluster.data,
rate.mat = cluster_rate.mat,
node.states = "marginal",
rate.cat = 1, p = cluster.ER$rates,
root.p = cluster.ER$pi)
clusterasr <- cluster_fit.marginal$states
colnames(clusterasr) <- colnames(cluster_rate.mat)
colnames(clusterasr) <- gsub("/","+", colnames(clusterasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_cluster_guerbrown.svg", width = 20, height = 10)
clusterpp <- matrix(0, length(cluster), 3, dimnames = list(names(cluster), c("0", "1", "0+1")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
clusterX <- strsplit(setNames(as.character(cluster_rate.mat), names(cluster_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),2,
dimnames=list(S$tip.label,
c("0", "1")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
clusterX[[S$tip.label[i]]]]<-
rep(1/length(clusterX[[S$tip.label[i]]]),
length(clusterX[[S$tip.label[i]]]))
clustercols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1"))
par(fg="white")
cluster <- setNames(data$cluster, data$Synergus)
clusterxx <- strsplit(as.character(cluster), split = "+", fixed = T)
clusterpp <- matrix(0, length(cluster), 3, dimnames = list(names(cluster), c("0", "1", "0+1")))
for (i in 1:nrow(clusterpp)) clusterpp[i,clusterxx[[i]]]<-1/length(clusterxx[[i]])
tiplabels(pie = clusterpp, piecol = clustercols, cex=0.3)
par(fg="white")
piecol <- clustercols
for(i in 1:ncol(clusterasr)){
clusternn <- strsplit(colnames(clusterasr)[i],"+", fixed=TRUE)[[1]]
if(length(clusternn)==1) piecol[i] <- clustercols[clusternn]
else if(length(clusternn)==2) piecol[i] <- colorRampPalette(clustercols[clusternn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(clusterasr)
par(fg="white")
nodelabels(pie = clusterasr, piecol = clustercols,cex=0.40)
par(fg="black")
legend("bottom", c("Single Gall", "Cluster Gall", "Both"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15"), pt.cex = 2, title = "Gall Clustering", cex = 1)
clusterasr
#dev.off()
clusterpp <- matrix(0, length(cluster), 3, dimnames = list(names(cluster), c("0", "1", "0+1")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
clusterX <- strsplit(setNames(as.character(cluster_rate.mat), names(cluster_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),2,
dimnames=list(S$tip.label,
c("0", "1")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
clusterX[[S$tip.label[i]]]]<-
rep(1/length(clusterX[[S$tip.label[i]]]),
length(clusterX[[S$tip.label[i]]]))
clustercols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1"))
par(fg="white")
cluster <- setNames(data$cluster, data$Synergus)
clusterxx <- strsplit(as.character(cluster), split = "+", fixed = T)
clusterpp <- matrix(0, length(cluster), 3, dimnames = list(names(cluster), c("0", "1", "0+1")))
for (i in 1:nrow(clusterpp)) clusterpp[i,clusterxx[[i]]]<-1/length(clusterxx[[i]])
tiplabels(pie = clusterpp, piecol = clustercols, cex=0.3)
par(fg="white")
piecol <- clustercols
for(i in 1:ncol(clusterasr)){
clusternn <- strsplit(colnames(clusterasr)[i],"+", fixed=TRUE)[[1]]
if(length(clusternn)==1) piecol[i] <- clustercols[clusternn]
else if(length(clusternn)==2) piecol[i] <- colorRampPalette(clustercols[clusternn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(clusterasr)
par(fg="white")
nodelabels(pie = clusterasr, piecol = clustercols,cex=0.40)
par(fg="black")
legend("bottom", c("Single Gall", "Both", "Cluster"), pch = 21, pt.bg = c("firebrick1", "grey15", "dodgerblue1"), pt.cex = 2, title = "Gall Clustering", cex = 1)
cluster <- setNames(data$cluster, rownames(data))
levels(cluster) <- unique(data$cluster)
cluster.ER <- fitpolyMk(S, cluster, model = "ER")
clusterxx <- apply(cluster.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(cluster.ER$data))
clusterxx <- gsub("+","/", clusterxx, fixed=TRUE)
cluster.data <- data.frame(Genus_sp = names(clusterxx), cluster = clusterxx)
cluster_rate.mat <- cluster.ER$index.matrix
cluster_rate.mat[cluster_rate.mat==0] <- NA
colnames(cluster_rate.mat) <- rownames(cluster_rate.mat) <- gsub("+","/", colnames(cluster_rate.mat), fixed=TRUE)
clusterind <- order(colnames(cluster_rate.mat))
cluster_rate.mat <- cluster_rate.mat[clusterind, clusterind]
cluster_fit.marginal <- corHMM(S, cluster.data,
rate.mat = cluster_rate.mat,
node.states = "marginal",
rate.cat = 1, p = cluster.ER$rates,
root.p = cluster.ER$pi)
clusterasr <- cluster_fit.marginal$states
colnames(clusterasr) <- colnames(cluster_rate.mat)
colnames(clusterasr) <- gsub("/","+", colnames(clusterasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_cluster_guerbrown.svg", width = 20, height = 10)
clusterpp <- matrix(0, length(cluster), 3, dimnames = list(names(cluster), c("0", "1", "0+1")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
clusterX <- strsplit(setNames(as.character(cluster_rate.mat), names(cluster_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),2,
dimnames=list(S$tip.label,
c("0", "1")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
clusterX[[S$tip.label[i]]]]<-
rep(1/length(clusterX[[S$tip.label[i]]]),
length(clusterX[[S$tip.label[i]]]))
clustercols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1"))
par(fg="white")
cluster <- setNames(data$cluster, data$Synergus)
clusterxx <- strsplit(as.character(cluster), split = "+", fixed = T)
clusterpp <- matrix(0, length(cluster), 3, dimnames = list(names(cluster), c("0", "1", "0+1")))
for (i in 1:nrow(clusterpp)) clusterpp[i,clusterxx[[i]]]<-1/length(clusterxx[[i]])
tiplabels(pie = clusterpp, piecol = clustercols, cex=0.3)
par(fg="white")
piecol <- clustercols
for(i in 1:ncol(clusterasr)){
clusternn <- strsplit(colnames(clusterasr)[i],"+", fixed=TRUE)[[1]]
if(length(clusternn)==1) piecol[i] <- clustercols[clusternn]
else if(length(clusternn)==2) piecol[i] <- colorRampPalette(clustercols[clusternn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(clusterasr)
par(fg="white")
nodelabels(pie = clusterasr, piecol = clustercols,cex=0.40)
par(fg="black")
legend("bottom", c("Single Gall", "Cluster Gall", "Both"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15"), pt.cex = 2, title = "Gall Clustering", cex = 1)
clusterasr
#dev.off()
detachable <- setNames(data$detachable, rownames(data))
levels(detachable) <- unique(data$detachable)
detachable.ER <- fitpolyMk(S, detachable, model = "ER")
detachablexx <- apply(detachable.ER$data,1,
function(x,ss) ss[which(x==1)],
ss=colnames(detachable.ER$data))
detachablexx <- gsub("+","/", detachablexx, fixed=TRUE)
detachable.data <- data.frame(Genus_sp = names(detachablexx), detachable = detachablexx)
detachable_rate.mat <- detachable.ER$index.matrix
detachable_rate.mat[detachable_rate.mat==0] <- NA
colnames(detachable_rate.mat) <- rownames(detachable_rate.mat) <- gsub("+","/", colnames(detachable_rate.mat), fixed=TRUE)
detachableind <- order(colnames(detachable_rate.mat))
detachable_rate.mat <- detachable_rate.mat[detachableind, detachableind]
detachable_fit.marginal <- corHMM(S, detachable.data,
rate.mat = detachable_rate.mat,
node.states = "marginal",
rate.cat = 1, p = detachable.ER$rates,
root.p = detachable.ER$pi)
detachableasr <- detachable_fit.marginal$states
colnames(detachableasr) <- colnames(detachable_rate.mat)
colnames(detachableasr) <- gsub("/","+", colnames(detachableasr))
#svg("/home/guerbrown/github_local/biol-4386-course-project-guerbrown/output/inqcophy_traitmodeling_detachable_guerbrown.svg", width = 20, height = 10)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
plot.phylo(S, type = "fan", cex = 1.1, align.tip.label = F, lwd = 2, label.offset = 0.05, use.edge.length = F, open.angle =  163, node.depth = 100)
detachableX <- strsplit(setNames(as.character(detachable_rate.mat), names(detachable_rate.mat)),"+", fixed=TRUE)
pies <- matrix(0, Ntip(S),3,
dimnames=list(S$tip.label,
c("1", "0", "1+0")))
for(i in 1:Ntip(S))
pies[S$tip.label[i],
detachableX[[S$tip.label[i]]]]<-
rep(1/length(detachableX[[S$tip.label[i]]]),
length(detachableX[[S$tip.label[i]]]))
detachablecols <- setNames(c("firebrick1", "dodgerblue1", "grey15"),
c("0", "1"))
par(fg="white")
detachable <- setNames(data$detachable, data$Synergus)
detachablexx <- strsplit(as.character(detachable), split = "+", fixed = T)
detachablepp <- matrix(0, length(detachable), 3, dimnames = list(names(detachable), c("1", "0", "1+0")))
for (i in 1:nrow(detachablepp)) detachablepp[i,detachablexx[[i]]]<-1/length(detachablexx[[i]])
tiplabels(pie = detachablepp, piecol = detachablecols, cex=0.3)
par(fg="white")
piecol <- detachablecols
for(i in 1:ncol(detachableasr)){
detachablenn <- strsplit(colnames(detachableasr)[i],"+", fixed=TRUE)[[1]]
if(length(detachablenn)==1) piecol[i] <- detachablecols[detachablenn]
else if(length(detachablenn)==2) piecol[i] <- colorRampPalette(detachablecols[detachablenn])(3)[2]
else piecol[i]<-"black"
}
names(piecol)<-colnames(detachableasr)
par(fg="white")
nodelabels(pie = detachableasr, piecol = detachablecols,cex=0.40)
par(fg="black")
legend("bottom", c("Detachable", "Integrated", "No Preference"), pch = 21, pt.bg = c("firebrick1", "dodgerblue1", "grey15"), pt.cex = 2, title = "Detachable", cex = 1)
#dev.off()
